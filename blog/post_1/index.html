<!DOCTYPE html>
<html lang="en-us"><head>
  <title></title>

<meta name="theme-color" content="" />
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1.0" name="viewport" />
<meta name="description" content="" />
<meta name="author" content="" />
<meta name="generator" content="aafu theme by Darshan in Hugo 0.74.3" />



  <link
    rel="stylesheet"
    href="https://bharathravu.github.io/css/bootstrap/bootstrap.min.css"
  />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
    integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
    crossorigin="anonymous"
  />
  <link
    rel="stylesheet"
    href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css"
  />
  <link
    rel="stylesheet"
    href="//fonts.googleapis.com/css?family=Didact+Gothic%7CRoboto:400%7CRoboto+Mono"
  />
  <link rel="stylesheet" href="https://bharathravu.github.io/css/aafu_light.css" />
  <link rel="stylesheet" href="https://bharathravu.github.io/css/aafu.css" />

  <script>
    var themeColor = document.querySelector("meta[name=theme-color]");
    window.onload = () => {
      themeColor.content = getComputedStyle(document.body)["background-color"];
      let defaultActivePanel = document.querySelector(".accordion.active");
      if (defaultActivePanel) {
        defaultActivePanel.nextElementSibling.style.maxHeight =
          defaultActivePanel.nextElementSibling.scrollHeight + "px";
      }
    };
    window.onresize = () => {
      let defaultActivePanel = document.querySelector(".accordion.active");
      if (defaultActivePanel) {
        defaultActivePanel.nextElementSibling.style.maxHeight =
          defaultActivePanel.nextElementSibling.scrollHeight + "px";
      }
    };
  </script>
  <script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    tags: 'ams'
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

</head>
<body class="container">
    <main style="min-height: calc(100vh - 60px);">
      
      <div class="d-flex flex-row row p-2">
  <h3 class="main-menu mr-3">
    <a href="https://bharathravu.github.io/">Home </a>
  </h3>
  <h3 class="main-menu mr-3">
    <a href="https://bharathravu.github.io/blog">Blog</a>
  </h3>
</div>

      
<div class="rounded p-2 aafu-border border">
  <div class="border-bottom aafu-border">
    <h1 class="top-h1" style="font-size: 2.75em;">vestibulum vitae dictum aliqua phasellus magnis at</h1><div class="mb-2">
  <p class="mb-1">May 30, 2018</p>
   
  
  <p class="metadata-value mb-1 taxa taxa-container-div list-categories">
    Categories: 
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="https://bharathravu.github.io/categories/aliquam-auctor"
      title="categories"
    >aliquam auctor</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="https://bharathravu.github.io/categories/do"
      title="categories"
    >do</a>
    
  </p>
  
  
  
  <p class="metadata-value mb-1 taxa taxa-container-div list-tags">
    Tags: 
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="https://bharathravu.github.io/tags/aliquam-incididunt"
      title="tags"
    >aliquam incididunt</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="https://bharathravu.github.io/tags/notes"
      title="tags"
    >notes</a>
    
    <a
      class="pl-1 pr-1 rounded border border-secondary"
      href="https://bharathravu.github.io/tags/velit"
      title="tags"
    >velit</a>
    
  </p>
  
  
</div>
</div>
  <div class="content">
    <h1 id="eu-velit-magna-aliqua-hendrerit">eu velit magna aliqua hendrerit</h1>
<ul>
<li><img src="https://bharathravu.github.io/images/Anscombe.png" alt="Anscombe"><br>
One of the assumptions in financial modelling is that the returns of a security is a random variable. The standard deviation of the return is considered to be a measure of risk. The expected return should be higher for riskier securites and lower for safer securities.</li>
</ul>
<p>For a portfolio with $N$ securities,<br>
Portfolio value at time=0, $V(0)=\sum_{i=1}^N x_i S_i(0)$, where $x_i$ is the number of shares and $S_i(0)$ is the price of the security $i$.<br>
Weights of the securities for the portfolio, $w_i=\frac{x_i S_i(0)}{V(0)}$ such that $\sum_{i=1}^N w_i=1$.<br>
Return of the portfolio $R_p = \sum_{i=1}^N w_i R_i$, where $R_i$ is the return of security $i$.<br>
Expected return of the portfolio $E(R_p)=\sum_{i=1}^N w_i E(R_i)$<br>
Variance of the portfolio $Var(R_p)=E(R_p^2)-E(R_p)^2$</p>
<p>The relationship between the log return (or continously compounded return) and the simple return is $r_t= log(1+R_t)$ or $R_t=e^{r_t}-1$. Log returns are more useful becuase of the additivity of risks. Lets see this below.</p>
<ul>
<li>For mutliperiod ($k$ periods) returns,  $r_t[k]=r_t + r_{t-1} + \ldots + r_{t-k+1}$.</li>
<li>$Var(r_t[k]) = Var(r_t) + Var(r_{t-1}) + \ldots + Var(r_{t-k+1})$. This holds true only when $r_i$ are independent.</li>
</ul>
<p>Expected log return of the portfolio $E(r_p) \approx \sum_{i=1}^N w_i E(r_i)$<br>
Variance of the log returns of the portfolio $Var(r_p)=E(r_p^2)-E(r_p)^2$, where $r_p = \sum_{i=1}^N w_i r_i$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">%</span>matplotlib inline
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Constants</span>
data_folder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;data_2020_09_25&#39;</span>
variable<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Adj Close&#39;</span>
start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2010-09-25&#39;</span>
end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2020-09-25&#39;</span>
n_stocks<span style="color:#f92672">=</span>len(os<span style="color:#f92672">.</span>listdir(data_folder))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_stocks_data_from_folder</span>(data_folder, variable, start_date, end_date):
    files_list<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>listdir(data_folder)
    df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame()
    <span style="color:#66d9ef">for</span> filename <span style="color:#f92672">in</span> files_list:
        file_path<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(data_folder,filename)
        col_name<span style="color:#f92672">=</span>filename<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;.NS.csv&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>)
        df[col_name]<span style="color:#f92672">=</span>read_stock_variable_from_CSV(file_path,variable,start_date, end_date)[variable]

    <span style="color:#66d9ef">return</span> df

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read_stock_variable_from_CSV</span>(file_path,variable,start_date, end_date):
    data<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>read_csv(file_path)
    data[<span style="color:#e6db74">&#39;Date&#39;</span>] <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;Date&#39;</span>]<span style="color:#f92672">.</span>apply(pd<span style="color:#f92672">.</span>to_datetime)
    data<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;Date&#39;</span>,inplace<span style="color:#f92672">=</span>True)
    mask <span style="color:#f92672">=</span> (data<span style="color:#f92672">.</span>index <span style="color:#f92672">&gt;=</span> start_date) <span style="color:#f92672">&amp;</span> (data<span style="color:#f92672">.</span>index <span style="color:#f92672">&lt;=</span> end_date)
    <span style="color:#66d9ef">return</span> data<span style="color:#f92672">.</span>loc[mask][[<span style="color:#e6db74">&#39;Adj Close&#39;</span>]]
</code></pre></div><p>Adjusted closing is closing price but it includes stock splitting, dividends, etc.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_adj_close<span style="color:#f92672">=</span>get_stocks_data_from_folder(data_folder, <span style="color:#e6db74">&#39;Adj Close&#39;</span>, start_date, end_date)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">missing_values_count <span style="color:#f92672">=</span> data_adj_close<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()
<span style="color:#66d9ef">print</span>(missing_values_count)
data_adj_close<span style="color:#f92672">.</span>dropna(inplace<span style="color:#f92672">=</span>True)
</code></pre></div><pre><code>AXISBANK     8
DABUR        8
DRREDDY      8
ICICIBANK    8
INFY         8
RELIANCE     8
SBIN         8
SUNPHARMA    8
TCS          8
dtype: int64
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_adj_close<span style="color:#f92672">.</span>plot(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">8</span>))
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1219cbdf708&gt;
</code></pre>
<p><img src="https://bharathravu.github.io/output_6_1.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_returns<span style="color:#f92672">=</span> data_adj_close<span style="color:#f92672">.</span>pct_change(<span style="color:#ae81ff">1</span>)
daily_returns<span style="color:#f92672">.</span>dropna(inplace<span style="color:#f92672">=</span>True)
daily_logreturns<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>log(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>daily_returns)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_logreturns[<span style="color:#e6db74">&#39;AXISBANK&#39;</span>]<span style="color:#f92672">.</span>plot(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">8</span>))
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1219d46c048&gt;
</code></pre>
<p><img src="output_8_1.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_logreturns[<span style="color:#e6db74">&#39;DABUR&#39;</span>]<span style="color:#f92672">.</span>plot(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">8</span>))
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1219d4fcbc8&gt;
</code></pre>
<p><img src="output_9_1.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_logreturns<span style="color:#f92672">.</span>plot(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">8</span>))
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1bc3ef49a08&gt;
</code></pre>
<p><img src="output_10_1.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">10</span>))
ax <span style="color:#f92672">=</span> fig<span style="color:#f92672">.</span>gca()
daily_logreturns<span style="color:#f92672">.</span>hist(ax <span style="color:#f92672">=</span> ax,bins<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
</code></pre></div><pre><code>C:\Users\bharath\Anaconda3\lib\site-packages\ipykernel_launcher.py:3: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared
  This is separate from the ipykernel package so we can avoid doing imports until





array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D1DBA88&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D39A888&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D3D4308&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D5BA0C8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D5EEF08&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D623888&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D65E6C8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D695548&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001BC3D6A0C88&gt;]],
      dtype=object)
</code></pre>
<p><img src="output_11_2.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_logreturns<span style="color:#f92672">.</span>mean()<span style="color:#f92672">*</span><span style="color:#ae81ff">252</span> <span style="color:#75715e"># per year</span>
</code></pre></div><pre><code>AXISBANK     0.059558
DABUR        0.168364
DRREDDY      0.133080
ICICIBANK    0.107442
INFY         0.184585
RELIANCE     0.164989
SBIN         0.014902
SUNPHARMA    0.100159
TCS          0.193752
dtype: float64
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_logreturns<span style="color:#f92672">.</span>cov()<span style="color:#f92672">*</span><span style="color:#ae81ff">252</span> <span style="color:#75715e"># per year</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_portfolio_return</span>(weights, daily_logreturns):
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>sum(daily_logreturns<span style="color:#f92672">.</span>mean()<span style="color:#f92672">*</span>weights)<span style="color:#f92672">*</span><span style="color:#ae81ff">252</span> <span style="color:#75715e"># per year - 252 trading days</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_portfolio_variance</span>(weights, daily_logreturns):
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>sqrt(np<span style="color:#f92672">.</span>dot(weights<span style="color:#f92672">.</span>T, np<span style="color:#f92672">.</span>dot(daily_logreturns<span style="color:#f92672">.</span>cov()<span style="color:#f92672">*</span><span style="color:#ae81ff">252</span>,weights)))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_porfolios_stats_randomly</span>(daily_logreturns, n_portfolios):
    n_stocks<span style="color:#f92672">=</span>len(daily_logreturns<span style="color:#f92672">.</span>columns)
    pf_returns<span style="color:#f92672">=</span>[]
    pf_variances<span style="color:#f92672">=</span>[]

    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n_portfolios):
        weights<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>random(n_stocks)
        weights <span style="color:#f92672">/=</span> np<span style="color:#f92672">.</span>sum(weights)
        pf_returns<span style="color:#f92672">.</span>append(get_portfolio_return(weights, daily_logreturns))
        pf_variances<span style="color:#f92672">.</span>append(get_portfolio_variance(weights, daily_logreturns))

    pf_returns<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array(pf_returns)
    pf_variances<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array(pf_variances)
    <span style="color:#66d9ef">return</span> pf_returns, pf_variances
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">returns, variances <span style="color:#f92672">=</span> generate_porfolios_stats_randomly(daily_logreturns, <span style="color:#ae81ff">10000</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_portfolios</span>(pfreturns,pfvariances):
    plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">8</span>))
    plt<span style="color:#f92672">.</span>scatter(pfvariances, pfreturns,c<span style="color:#f92672">=</span>pfreturns<span style="color:#f92672">/</span>pfvariances, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span> , edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
    plt<span style="color:#f92672">.</span>grid(True)
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Expected Variance&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Expected Return&#39;</span>)
    plt<span style="color:#f92672">.</span>colorbar(label<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Sharp Ratio&#39;</span>)
    plt<span style="color:#f92672">.</span>show()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plot_portfolios(returns,variances)
</code></pre></div><p><img src="output_19_0.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_portfolio_stats</span>(weights, daily_logreturns):
    pf_return<span style="color:#f92672">=</span>get_portfolio_return(weights, daily_logreturns)
    pf_variance<span style="color:#f92672">=</span>get_portfolio_variance(weights, daily_logreturns)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>array([pf_return, pf_variance, pf_return<span style="color:#f92672">/</span>pf_variance])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_portfolio_sharp_ration</span>(weights, daily_logreturns):
    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>get_portfolio_stats(weights, daily_logreturns)[<span style="color:#ae81ff">2</span>]
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> scipy.optimize <span style="color:#f92672">import</span> minimize
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">optimize_portfolio</span>(daily_logreturns):
    n_stocks<span style="color:#f92672">=</span>len(daily_logreturns<span style="color:#f92672">.</span>columns)
    bounds <span style="color:#f92672">=</span> tuple((<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(n_stocks))
    con<span style="color:#f92672">=</span>({<span style="color:#e6db74">&#39;type&#39;</span>:<span style="color:#e6db74">&#39;eq&#39;</span>,<span style="color:#e6db74">&#39;fun&#39;</span>: <span style="color:#66d9ef">lambda</span> x: np<span style="color:#f92672">.</span>sum(x)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>})
    weights<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>random(n_stocks)
    weights <span style="color:#f92672">/=</span> np<span style="color:#f92672">.</span>sum(weights)
    optimum_pf<span style="color:#f92672">=</span>minimize(fun<span style="color:#f92672">=</span>get_portfolio_sharp_ration, x0<span style="color:#f92672">=</span>weights, args<span style="color:#f92672">=</span>daily_logreturns, bounds<span style="color:#f92672">=</span>bounds, method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;SLSQP&#39;</span>, constraints<span style="color:#f92672">=</span>con)
    <span style="color:#66d9ef">return</span> optimum_pf
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">opt_pf<span style="color:#f92672">=</span>optimize_portfolio(daily_logreturns)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Optimal weights:&#39;</span>,opt_pf[<span style="color:#e6db74">&#39;x&#39;</span>]<span style="color:#f92672">.</span>round(<span style="color:#ae81ff">3</span>))
</code></pre></div><pre><code>Optimal weights: [0.    0.299 0.152 0.    0.131 0.129 0.    0.    0.29 ]
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">AXISBANK 	DABUR 	DRREDDY 	ICICIBANK 	INFY 	RELIANCE 	SBIN 	SUNPHARMA 	TCS
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># optimum portfolio statistics</span>
opt_pf_stats<span style="color:#f92672">=</span>get_portfolio_stats(opt_pf[<span style="color:#e6db74">&#39;x&#39;</span>],daily_logreturns)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Expected return, Volatility and Sharp ratio:&#39;</span>,opt_pf_stats)
</code></pre></div><pre><code>Expected return, Volatility and Sharp ratio: [0.17205126 0.16731228 1.02832414]
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_optimum_portfolios</span>(pfreturns,pfvariances):
    plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">8</span>))
    plt<span style="color:#f92672">.</span>scatter(pfvariances, pfreturns,c<span style="color:#f92672">=</span>pfreturns<span style="color:#f92672">/</span>pfvariances, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span> , edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
    plt<span style="color:#f92672">.</span>plot(opt_pf_stats[<span style="color:#ae81ff">1</span>],opt_pf_stats[<span style="color:#ae81ff">0</span>],<span style="color:#e6db74">&#39;g*&#39;</span>, markersize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
    plt<span style="color:#f92672">.</span>grid(True)
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Expected Variance&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Expected Return&#39;</span>)
    plt<span style="color:#f92672">.</span>colorbar(label<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Sharp Ratio&#39;</span>)
    plt<span style="color:#f92672">.</span>show()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plot_optimum_portfolios(returns,variances)
</code></pre></div><ul>
<li><img src="https://bharathravu.github.io/content/blog/images/output_27_0.png" alt="your image"></li>
</ul>

  </div>
</div>
<div class="d-flex flex-row justify-content-center">
  <h3 class="mb-1 mt-1 text-left mr-4">
    
    <a
      href="https://bharathravu.github.io/blog/post_2/"
      title="enim ultricies dolore metus ac eiusmod interdum"
    >
      <i class="nav-menu fas fa-chevron-circle-left"></i>
    </a>
    
  </h3>
  <h3 class="mb-1 mt-1 text-left ml-4">
    
    <i class="nav-menu-disabled fas fa-chevron-circle-right"></i>
    
  </h3>
</div>


    </main>
    
    <footer class=" mt-2 mb-4 text-center ">
  <span class="markdownify"></span>
  <span style="font-size:0px;">
    &middot;
    <i>
      <a href="https://github.com/darshanbaral/aafu">
        aafu
      </a>
    </i>
    by
    <a href="https://www.darshanbaral.com/">
      darshan
    </a>
  </span>
</footer>

    
  </body>
</html>
